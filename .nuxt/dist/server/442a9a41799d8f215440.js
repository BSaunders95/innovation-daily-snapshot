exports.ids=[1],exports.modules={33:function(t,e){},38:function(t,e,o){"use strict";o.r(e);var n=o(33),r=o.n(n);for(var d in n)"default"!==d&&function(t){o.d(e,t,(function(){return n[t]}))}(d);e.default=r.a},41:function(t,e,o){"use strict";o.r(e);var n=o(11),r=o.n(n),d=o(27),l=o.n(d),c=o(28);const y={name:"",showInLegend:!1,marker:{symbol:"square"},data:[]};var h={mixins:[{components:{VueHighcharts:o.n(c).a,moment:l.a},data:()=>({options:{chart:{type:"line"},title:{text:null},xAxis:{type:"datetime",categories:[],labels:{formatter(){return l()(new Date(this.value)).format("DD/MM/YYYY")}}},yAxis:{title:{text:"Day position"},min:0,tickInterval:1},tooltip:{crosshairs:!0,shared:!0},credits:{enabled:!1},plotOptions:{line:{marker:{radius:4,lineColor:"#666666",lineWidth:1}},series:{point:{events:{click(){!function(t){document.getElementById("showModalBtn").dispatchEvent(new Event("click"));const e=document.getElementById("selectedDate");e.value=t,e.dispatchEvent(new Event("change"))}(this.category)}}}}},series:[]}}),methods:{load(){const t=this.$refs.lineCharts;t.delegateMethod("showLoading","Loading..."),setTimeout(()=>{t.removeSeries(),t.addSeries(y),t.hideLoading()},500)},setXAxis(t){const e=this.options.xAxis.categories;e.splice(0,e.length);for(let i=0;i<t.length;i++)e.push(t[i])},setYAxis(t){y.data=t},addData(t,e){this.setYAxis(e),this.setXAxis(t),this.load()}}}],data:()=>({department:{},latestDayPosition:0,latestDayPositionDate:null,latestDayPositionVariant:"",dateRange:"30",dateRangeSelectOptions:[{value:"30",text:"30 Days"},{value:"60",text:"60 Days"},{value:"90",text:"90 Days"}],snapshots:[],dayPositionDetails:{},csv_fields:{Date:"date",Received:"received",Processed:"processed",Remaining:"remaining","Day Position":"dayPosition"},csv_data:[],json_meta:[[{key:"charset",value:"utf-8"}]],showAddOrChangeDayPosition:!1,errors:{},hasDayPositionError:!1}),watch:{dateRange(){this.getDayPositions()},"dayPositionDetails.date"(){this.getDayPositionDetails()}},methods:{async getDepartment(){const t=this;await r.a.get("/api/departments/"+this.$route.params.id).then((function(e){t.department=e.data,t.getLatestDayPosition(),t.getDayPositions()}))},async getDayPositionHistory(){const t=this;await r.a.get("/api/dayposition/"+this.$route.params.id+"/history").then((function(e){t.csv_data=e.data}))},getDayPositions(){const t=this;r.a.get("/api/daypositions/"+this.$route.params.id+"?time="+this.dateRange).then((function(e){t.addData(e.data[0],e.data[1])}))},getLatestDayPosition(){const t=this;r.a.get("/api/dayposition/"+t.$route.params.id+"/latest").then((function(e){t.latestDayPosition=e.data.latestDayPosition,t.latestDayPositionDate=l()(new Date(e.data.latestDayPositionDate)).format("DD/MM/YYYY"),t.latestDayPosition<=t.department.maxSuccess?t.latestDayPositionVariant="success":t.latestDayPosition<=t.department.maxWarning?t.latestDayPositionVariant="warning":t.latestDayPositionVariant="danger"}))},getDayPositionDetails(){if(void 0!==this.dayPositionDetails.date){const t=this;r.a.get("/api/dayposition/"+t.$route.params.id+"?date="+t.dayPositionDetails.date).then((function(e){delete e.data._id,t.dayPositionDetails=e.data}))}},saveDayPositionDetails(){const t=this;t.dayPositionDetails.dept=t.$route.params.id,r.a.post("/api/dayposition",t.dayPositionDetails).then(e=>{t.showAddOrChangeDayPosition=!1,t.dayPositionDetails={},t.getLatestDayPosition(),t.getDayPositions(),t.getDayPositionHistory()}).catch(e=>{t.errors=e.response.data,void 0!==t.errors.dayPositionError&&(t.hasDayPositionError=!0)})},getCSVFileName(){return"daily-snapshot-history-"+this.$route.params.id+"-"+(new Date).toISOString().split("T")[0]},clearErrors(){this.errors={},this.hasDayPositionError=!1}},mounted(){this.getDepartment(),this.getDayPositionHistory()}},D=o(1);var component=Object(D.a)(h,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"container-fluid mt-4"},[t._ssrNode('<h1 class="h1" style="padding-bottom: 40px">'+t._ssrEscape("\n    "+t._s(t.department.name)+"\n  ")+"</h1> "),t._ssrNode('<h2 style="padding-bottom: 40px">',"</h2>",[t._ssrNode("<p>\n      Latest day position\n      <b>"+t._ssrEscape("\n        "+t._s(t.latestDayPosition)+"\n      ")+"</b>"+t._ssrEscape(" at "+t._s(t.latestDayPositionDate)+"\n    ")+"</p> "),o("b-progress",{attrs:{value:t.latestDayPosition,max:t.department.maxDayPosition,variant:t.latestDayPositionVariant}})],2),t._ssrNode(" "),o("b-row",[o("b-col",[o("b-row",{staticClass:"justify-content-md-center"},[o("b-col",{attrs:{col:"",sm:"2"}},[o("b-form-select",{staticClass:"m-md-2",attrs:{options:t.dateRangeSelectOptions},model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1)],1),t._v(" "),o("div",[o("vue-highcharts",{ref:"lineCharts",attrs:{options:t.options}})],1),t._v(" "),t.$auth.$state.loggedIn&&(t.$auth.$state.user.superUser||t.$auth.$state.user.authRoles.includes(t.$route.params.id))?o("b-row",{staticClass:"justify-content-md-center"},[o("b-col",{attrs:{col:"",sm:"2"}},[o("b-btn",{attrs:{id:"showModalBtn",pill:"",variant:"outline-secondary"},on:{click:function(e){t.showAddOrChangeDayPosition=!0}}},[t._v("\n            +\n          ")])],1)],1):t._e(),t._v(" "),t.$auth.$state.loggedIn&&(t.$auth.$state.user.superUser||t.$auth.$state.user.authRoles.includes(t.$route.params.id))?o("b-row",{staticClass:"justify-content-md-center"},[o("b-col",{attrs:{sm:"2"}},[o("div",[t._v("Â ")]),t._v(" "),o("download-excel",{staticClass:"btn btn-outline-secondary",attrs:{data:t.csv_data,fields:t.csv_fields,type:"csv",name:t.getCSVFileName()}},[t._v("\n            Download history CSV\n          ")])],1)],1):t._e()],1),t._v(" "),o("b-modal",{attrs:{title:"Day position",name:"show-add-or-change-day-position","header-bg-variant":"secondary"},on:{hide:t.clearErrors},scopedSlots:t._u([{key:"modal-footer",fn:function(){return[o("b-button",{staticClass:"float-right",attrs:{variant:"outline-secondary",size:"sm"},on:{click:t.saveDayPositionDetails}},[t._v("\n          Save\n        ")])]},proxy:!0}]),model:{value:t.showAddOrChangeDayPosition,callback:function(e){t.showAddOrChangeDayPosition=e},expression:"showAddOrChangeDayPosition"}},[o("b-alert",{attrs:{variant:"danger"},model:{value:t.hasDayPositionError,callback:function(e){t.hasDayPositionError=e},expression:"hasDayPositionError"}},[t._v("\n        "+t._s(t.errors.dayPositionError)+"\n      ")]),t._v(" "),o("b-card",[o("form",[o("b-form-group",{attrs:{label:"Date"}},[o("b-form-input",{attrs:{type:"date",max:(new Date).toISOString().split("T")[0]},model:{value:t.dayPositionDetails.date,callback:function(e){t.$set(t.dayPositionDetails,"date",e)},expression:"dayPositionDetails.date"}})],1),t._v(" "),o("b-form-group",{attrs:{label:"Recieved"}},[o("b-form-input",{attrs:{type:"number"},model:{value:t.dayPositionDetails.received,callback:function(e){t.$set(t.dayPositionDetails,"received",t._n(e))},expression:"dayPositionDetails.received"}})],1),t._v(" "),o("b-form-group",{attrs:{label:"Processed"}},[o("b-form-input",{attrs:{type:"number"},model:{value:t.dayPositionDetails.processed,callback:function(e){t.$set(t.dayPositionDetails,"processed",t._n(e))},expression:"dayPositionDetails.processed"}})],1),t._v(" "),o("b-form-group",{attrs:{label:"Remaining"}},[o("b-form-input",{attrs:{type:"number"},model:{value:t.dayPositionDetails.remaining,callback:function(e){t.$set(t.dayPositionDetails,"remaining",t._n(e))},expression:"dayPositionDetails.remaining"}})],1),t._v(" "),o("b-form-group",{attrs:{label:"Day position"}},[o("b-form-input",{attrs:{type:"number"},model:{value:t.dayPositionDetails.dayPosition,callback:function(e){t.$set(t.dayPositionDetails,"dayPosition",t._n(e))},expression:"dayPositionDetails.dayPosition"}})],1)],1)])],1)],1),t._ssrNode(" "),o("b-form-input",{attrs:{id:"selectedDate",type:"date",hidden:""},model:{value:t.dayPositionDetails.date,callback:function(e){t.$set(t.dayPositionDetails,"date",e)},expression:"dayPositionDetails.date"}})],2)}),[],!1,(function(t){var e=o(38);e.__inject__&&e.__inject__(t)}),null,"e29c30ec");e.default=component.exports}};
//# sourceMappingURL=442a9a41799d8f215440.js.map