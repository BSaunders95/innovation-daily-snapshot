(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{226:function(t,e,n){},359:function(t,e,n){var map={"./af":228,"./af.js":228,"./ar":229,"./ar-dz":230,"./ar-dz.js":230,"./ar-kw":231,"./ar-kw.js":231,"./ar-ly":232,"./ar-ly.js":232,"./ar-ma":233,"./ar-ma.js":233,"./ar-sa":234,"./ar-sa.js":234,"./ar-tn":235,"./ar-tn.js":235,"./ar.js":229,"./az":236,"./az.js":236,"./be":237,"./be.js":237,"./bg":238,"./bg.js":238,"./bm":239,"./bm.js":239,"./bn":240,"./bn.js":240,"./bo":241,"./bo.js":241,"./br":242,"./br.js":242,"./bs":243,"./bs.js":243,"./ca":244,"./ca.js":244,"./cs":245,"./cs.js":245,"./cv":246,"./cv.js":246,"./cy":247,"./cy.js":247,"./da":248,"./da.js":248,"./de":249,"./de-at":250,"./de-at.js":250,"./de-ch":251,"./de-ch.js":251,"./de.js":249,"./dv":252,"./dv.js":252,"./el":253,"./el.js":253,"./en-SG":254,"./en-SG.js":254,"./en-au":255,"./en-au.js":255,"./en-ca":256,"./en-ca.js":256,"./en-gb":257,"./en-gb.js":257,"./en-ie":258,"./en-ie.js":258,"./en-il":259,"./en-il.js":259,"./en-nz":260,"./en-nz.js":260,"./eo":261,"./eo.js":261,"./es":262,"./es-do":263,"./es-do.js":263,"./es-us":264,"./es-us.js":264,"./es.js":262,"./et":265,"./et.js":265,"./eu":266,"./eu.js":266,"./fa":267,"./fa.js":267,"./fi":268,"./fi.js":268,"./fo":269,"./fo.js":269,"./fr":270,"./fr-ca":271,"./fr-ca.js":271,"./fr-ch":272,"./fr-ch.js":272,"./fr.js":270,"./fy":273,"./fy.js":273,"./ga":274,"./ga.js":274,"./gd":275,"./gd.js":275,"./gl":276,"./gl.js":276,"./gom-latn":277,"./gom-latn.js":277,"./gu":278,"./gu.js":278,"./he":279,"./he.js":279,"./hi":280,"./hi.js":280,"./hr":281,"./hr.js":281,"./hu":282,"./hu.js":282,"./hy-am":283,"./hy-am.js":283,"./id":284,"./id.js":284,"./is":285,"./is.js":285,"./it":286,"./it-ch":287,"./it-ch.js":287,"./it.js":286,"./ja":288,"./ja.js":288,"./jv":289,"./jv.js":289,"./ka":290,"./ka.js":290,"./kk":291,"./kk.js":291,"./km":292,"./km.js":292,"./kn":293,"./kn.js":293,"./ko":294,"./ko.js":294,"./ku":295,"./ku.js":295,"./ky":296,"./ky.js":296,"./lb":297,"./lb.js":297,"./lo":298,"./lo.js":298,"./lt":299,"./lt.js":299,"./lv":300,"./lv.js":300,"./me":301,"./me.js":301,"./mi":302,"./mi.js":302,"./mk":303,"./mk.js":303,"./ml":304,"./ml.js":304,"./mn":305,"./mn.js":305,"./mr":306,"./mr.js":306,"./ms":307,"./ms-my":308,"./ms-my.js":308,"./ms.js":307,"./mt":309,"./mt.js":309,"./my":310,"./my.js":310,"./nb":311,"./nb.js":311,"./ne":312,"./ne.js":312,"./nl":313,"./nl-be":314,"./nl-be.js":314,"./nl.js":313,"./nn":315,"./nn.js":315,"./pa-in":316,"./pa-in.js":316,"./pl":317,"./pl.js":317,"./pt":318,"./pt-br":319,"./pt-br.js":319,"./pt.js":318,"./ro":320,"./ro.js":320,"./ru":321,"./ru.js":321,"./sd":322,"./sd.js":322,"./se":323,"./se.js":323,"./si":324,"./si.js":324,"./sk":325,"./sk.js":325,"./sl":326,"./sl.js":326,"./sq":327,"./sq.js":327,"./sr":328,"./sr-cyrl":329,"./sr-cyrl.js":329,"./sr.js":328,"./ss":330,"./ss.js":330,"./sv":331,"./sv.js":331,"./sw":332,"./sw.js":332,"./ta":333,"./ta.js":333,"./te":334,"./te.js":334,"./tet":335,"./tet.js":335,"./tg":336,"./tg.js":336,"./th":337,"./th.js":337,"./tl-ph":338,"./tl-ph.js":338,"./tlh":339,"./tlh.js":339,"./tr":340,"./tr.js":340,"./tzl":341,"./tzl.js":341,"./tzm":342,"./tzm-latn":343,"./tzm-latn.js":343,"./tzm.js":342,"./ug-cn":344,"./ug-cn.js":344,"./uk":345,"./uk.js":345,"./ur":346,"./ur.js":346,"./uz":347,"./uz-latn":348,"./uz-latn.js":348,"./uz.js":347,"./vi":349,"./vi.js":349,"./x-pseudo":350,"./x-pseudo.js":350,"./yo":351,"./yo.js":351,"./zh-cn":352,"./zh-cn.js":352,"./zh-hk":353,"./zh-hk.js":353,"./zh-tw":354,"./zh-tw.js":354};function o(t){var e=r(t);return n(e)}function r(t){if(!n.o(map,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return map[t]}o.keys=function(){return Object.keys(map)},o.resolve=r,t.exports=o,o.id=359},361:function(t,e,n){"use strict";var o=n(226);n.n(o).a},365:function(t,e,n){"use strict";n.r(e);n(23),n(32);var o=n(10),r=n(109),l=n.n(r),d=n(224),c=n.n(d),y=n(360),m={name:"",showInLegend:!1,marker:{symbol:"square"},data:[]};var j,h,f={mixins:[{components:{VueHighcharts:n.n(y).a,moment:c.a},data:function(){return{options:{chart:{type:"line"},title:{text:null},xAxis:{type:"datetime",categories:[],labels:{formatter:function(){return c()(new Date(this.value)).format("DD/MM/YYYY")}}},yAxis:{title:{text:"Day position"},min:0,tickInterval:1},tooltip:{crosshairs:!0,shared:!0},credits:{enabled:!1},plotOptions:{line:{marker:{radius:4,lineColor:"#666666",lineWidth:1}},series:{point:{events:{click:function(){!function(t){document.getElementById("showModalBtn").dispatchEvent(new Event("click"));var e=document.getElementById("selectedDate");e.value=t,e.dispatchEvent(new Event("change"))}(this.category)}}}}},series:[]}}},methods:{load:function(){var t=this.$refs.lineCharts;t.delegateMethod("showLoading","Loading..."),setTimeout((function(){t.removeSeries(),t.addSeries(m),t.hideLoading()}),500)},setXAxis:function(t){var e=this.options.xAxis.categories;e.splice(0,e.length);for(var i=0;i<t.length;i++)e.push(t[i])},setYAxis:function(t){m.data=t},addData:function(t,e){this.setYAxis(e),this.setXAxis(t),this.load()}}}],data:function(){return{department:{},latestDayPosition:0,latestDayPositionDate:null,latestDayPositionVariant:"",dateRange:"30",dateRangeSelectOptions:[{value:"30",text:"30 Days"},{value:"60",text:"60 Days"},{value:"90",text:"90 Days"}],snapshots:[],dayPositionDetails:{},csv_fields:{Date:"date",Received:"received",Processed:"processed",Remaining:"remaining","Day Position":"dayPosition"},csv_data:[],json_meta:[[{key:"charset",value:"utf-8"}]],showAddOrChangeDayPosition:!1,errors:{},hasDayPositionError:!1}},watch:{dateRange:function(){this.getDayPositions()},"dayPositionDetails.date":function(){this.getDayPositionDetails()}},methods:{getDepartment:(h=Object(o.a)(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this,t.next=3,l.a.get("/api/departments/"+this.$route.params.id).then((function(t){e.department=t.data,e.getLatestDayPosition(),e.getDayPositions()}));case 3:case"end":return t.stop()}}),t,this)}))),function(){return h.apply(this,arguments)}),getDayPositionHistory:(j=Object(o.a)(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this,t.next=3,l.a.get("/api/dayposition/"+this.$route.params.id+"/history").then((function(t){e.csv_data=t.data}));case 3:case"end":return t.stop()}}),t,this)}))),function(){return j.apply(this,arguments)}),getDayPositions:function(){var t=this;l.a.get("/api/daypositions/"+this.$route.params.id+"?time="+this.dateRange).then((function(e){t.addData(e.data[0],e.data[1])}))},getLatestDayPosition:function(){var t=this;l.a.get("/api/dayposition/"+t.$route.params.id+"/latest").then((function(e){t.latestDayPosition=e.data.latestDayPosition,t.latestDayPositionDate=c()(new Date(e.data.latestDayPositionDate)).format("DD/MM/YYYY"),t.latestDayPosition<=t.department.maxSuccess?t.latestDayPositionVariant="success":t.latestDayPosition<=t.department.maxWarning?t.latestDayPositionVariant="warning":t.latestDayPositionVariant="danger"}))},getDayPositionDetails:function(){if(void 0!==this.dayPositionDetails.date){var t=this;l.a.get("/api/dayposition/"+t.$route.params.id+"?date="+t.dayPositionDetails.date).then((function(e){delete e.data._id,t.dayPositionDetails=e.data}))}},saveDayPositionDetails:function(){var t=this;t.dayPositionDetails.dept=t.$route.params.id,l.a.post("/api/dayposition",t.dayPositionDetails).then((function(e){t.showAddOrChangeDayPosition=!1,t.dayPositionDetails={},t.getLatestDayPosition(),t.getDayPositions(),t.getDayPositionHistory()})).catch((function(e){t.errors=e.response.data,void 0!==t.errors.dayPositionError&&(t.hasDayPositionError=!0)}))},getCSVFileName:function(){return"daily-snapshot-history-"+this.$route.params.id+"-"+(new Date).toISOString().split("T")[0]},clearErrors:function(){this.errors={},this.hasDayPositionError=!1}},mounted:function(){this.getDepartment(),this.getDayPositionHistory()}},v=(n(361),n(33)),component=Object(v.a)(f,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container-fluid mt-4"},[n("h1",{staticClass:"h1",staticStyle:{"padding-bottom":"40px"}},[t._v("\n    "+t._s(t.department.name)+"\n  ")]),t._v(" "),n("h2",{staticStyle:{"padding-bottom":"40px"}},[n("p",[t._v("\n      Latest day position\n      "),n("b",[t._v("\n        "+t._s(t.latestDayPosition)+"\n      ")]),t._v(" at "+t._s(t.latestDayPositionDate)+"\n    ")]),t._v(" "),n("b-progress",{attrs:{value:t.latestDayPosition,max:t.department.maxDayPosition,variant:t.latestDayPositionVariant}})],1),t._v(" "),n("b-row",[n("b-col",[n("b-row",{staticClass:"justify-content-md-center"},[n("b-col",{attrs:{col:"",sm:"2"}},[n("b-form-select",{staticClass:"m-md-2",attrs:{options:t.dateRangeSelectOptions},model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1)],1),t._v(" "),n("div",[n("vue-highcharts",{ref:"lineCharts",attrs:{options:t.options}})],1),t._v(" "),t.$auth.$state.loggedIn&&(t.$auth.$state.user.superUser||t.$auth.$state.user.authRoles.includes(t.$route.params.id))?n("b-row",{staticClass:"justify-content-md-center"},[n("b-col",{attrs:{col:"",sm:"2"}},[n("b-btn",{attrs:{id:"showModalBtn",pill:"",variant:"outline-secondary"},on:{click:function(e){t.showAddOrChangeDayPosition=!0}}},[t._v("\n            +\n          ")])],1)],1):t._e(),t._v(" "),t.$auth.$state.loggedIn&&(t.$auth.$state.user.superUser||t.$auth.$state.user.authRoles.includes(t.$route.params.id))?n("b-row",{staticClass:"justify-content-md-center"},[n("b-col",{attrs:{sm:"2"}},[n("div",[t._v("Â ")]),t._v(" "),n("download-excel",{staticClass:"btn btn-outline-secondary",attrs:{data:t.csv_data,fields:t.csv_fields,type:"csv",name:t.getCSVFileName()}},[t._v("\n            Download history CSV\n          ")])],1)],1):t._e()],1),t._v(" "),n("b-modal",{attrs:{title:"Day position",name:"show-add-or-change-day-position","header-bg-variant":"secondary"},on:{hide:t.clearErrors},scopedSlots:t._u([{key:"modal-footer",fn:function(){return[n("b-button",{staticClass:"float-right",attrs:{variant:"outline-secondary",size:"sm"},on:{click:t.saveDayPositionDetails}},[t._v("\n          Save\n        ")])]},proxy:!0}]),model:{value:t.showAddOrChangeDayPosition,callback:function(e){t.showAddOrChangeDayPosition=e},expression:"showAddOrChangeDayPosition"}},[n("b-alert",{attrs:{variant:"danger"},model:{value:t.hasDayPositionError,callback:function(e){t.hasDayPositionError=e},expression:"hasDayPositionError"}},[t._v("\n        "+t._s(t.errors.dayPositionError)+"\n      ")]),t._v(" "),n("b-card",[n("form",[n("b-form-group",{attrs:{label:"Date"}},[n("b-form-input",{attrs:{type:"date",max:(new Date).toISOString().split("T")[0]},model:{value:t.dayPositionDetails.date,callback:function(e){t.$set(t.dayPositionDetails,"date",e)},expression:"dayPositionDetails.date"}})],1),t._v(" "),n("b-form-group",{attrs:{label:"Recieved"}},[n("b-form-input",{attrs:{type:"number"},model:{value:t.dayPositionDetails.received,callback:function(e){t.$set(t.dayPositionDetails,"received",t._n(e))},expression:"dayPositionDetails.received"}})],1),t._v(" "),n("b-form-group",{attrs:{label:"Processed"}},[n("b-form-input",{attrs:{type:"number"},model:{value:t.dayPositionDetails.processed,callback:function(e){t.$set(t.dayPositionDetails,"processed",t._n(e))},expression:"dayPositionDetails.processed"}})],1),t._v(" "),n("b-form-group",{attrs:{label:"Remaining"}},[n("b-form-input",{attrs:{type:"number"},model:{value:t.dayPositionDetails.remaining,callback:function(e){t.$set(t.dayPositionDetails,"remaining",t._n(e))},expression:"dayPositionDetails.remaining"}})],1),t._v(" "),n("b-form-group",{attrs:{label:"Day position"}},[n("b-form-input",{attrs:{type:"number"},model:{value:t.dayPositionDetails.dayPosition,callback:function(e){t.$set(t.dayPositionDetails,"dayPosition",t._n(e))},expression:"dayPositionDetails.dayPosition"}})],1)],1)])],1)],1),t._v(" "),n("b-form-input",{attrs:{id:"selectedDate",type:"date",hidden:""},model:{value:t.dayPositionDetails.date,callback:function(e){t.$set(t.dayPositionDetails,"date",e)},expression:"dayPositionDetails.date"}})],1)}),[],!1,null,null,null);e.default=component.exports}}]);